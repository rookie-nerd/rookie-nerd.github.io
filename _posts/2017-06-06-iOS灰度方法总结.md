---
layout: post
title: iOS灰度方法总结
date: 2017-06-06
categories: iOS
---

因为苹果爸爸管的严，iOS开发者不能像Android开发者一样想怎么灰度就怎么灰度。然而灰度又是如此重要，不仅可以提前发现问题，保证版本质量，还能提早验证新特性，把握用户喜好。因此特总结几种iOS的灰度方法。

# 越狱渠道
越狱渠道有很多，Cydia、PP助手、91等都是比较有名的渠道，可以打出越狱渠道包，然后上传到这些平台，进行灰度。

但是这种模式局限也比较大。

1. 以前苹果AppStore特别慢的时候，越狱市场的灰度效果还是很好的，但现在越狱的用户越来越少了，现在能用越狱渠道进行灰度的，也就是那些大型app了。
2. 越狱渠道不能筛选用户，无法定向灰度。

# 企业证书
用企业证书打的app可以装在所有手机上，只要信任该证书，就能打开app，一般来说用在企业内部用来发布内部的app，bat都是用企业证书让内部员工试用新版本产品的。曾今也有企业直接使用企业证书对外发布app，被苹果直接封杀过。

企业证书的优点:

1. 不需要通过苹果的审核，想怎么灰就怎么灰
2. 没有人数限制

企业证书的缺点:

1. 需要额外点击信任该证书，才能打开app
2. 如果用户也装了线上版本，会出现2个相同的app

企业证书灰度的玩法其实很多，最核心的是需要自己线下维护一批用户，举例如下:

1. 用qq、微信、钉钉等社交工具维护一批活跃用户，在产品正式上线之前，先给这些用户发送企业证书打的安装包的二维码，让他们试用。
2. 大公司可以直接给公司全员发邮件试用。

# TestFlight
这是苹果官方给出的灰度的方法，能直接触达外部用户，非常值得一试。

但是，如果直接按照官方的方法搞，效果一定是很差的，为什么呢？整个灰度过程是这样的:

1. 首先发testflight邀请，是通过邮件的
2. 下TestFlight软件
3. 从TestFlight中下载灰度的安装包

试想，经过这三步，灰度的用户能有几个呢？所以必须要简化整个流程。后两点是无法简化的，只能将第一点简化掉。

1. 自己新建一个gmail邮箱，gmail邮箱的用户名是不区分大小写和点的，但苹果发送邀请是区分的，也就是说a.bcd@gmail.com和ab.cD@gmail.com苹果会分别给发邀请，而gmail只要登录abcd@gmail.com就能都收到，这样我们就不需要申请一堆邮箱了。
2. 每次给100个gmail邮箱发送邀请，登录邮箱收到邀请码，每次最多只能有2000个邀请码。这里有个小技巧，如果2000个不够用的话，可以将之前已经成功邀请的邮箱删掉，然后邀请额度就又有了。
3. 通过app自己的弹窗或者广告机制，将带有邀请码的升级url推送给筛选出来的用户即可。

这种方式的优点:

1. 官方支持，体验还可以，手机上不会出现多个app，而且正式版上线之后，能自动覆盖
2. 能按自己要求筛选用户，特别适合日活不多的app

缺点也很明显：

1. 有用户数限制
2. 整个步骤比较长，需要一定的开发量
3. 需要额外下一个testflight的app

